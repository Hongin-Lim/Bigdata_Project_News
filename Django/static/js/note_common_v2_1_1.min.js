
var NOTE_COMMON=NOTE_COMMON||{pagedebug:false,log:function(msg){"use strict";if(this.pagedebug){console.log(msg);}},dir:function(msg){"use strict";if(this.pagedebug){console.dir(msg);}}};var pageInfoFinder={cacheAvaible:["meta"],cacheData:{},inarray:function(haystack,needle){"use strict";var i=0,max=haystack.length;for(i=0;i<max;i+=1){if(haystack[i]===needle){return i;}}
return-1;},getCache:function(where,what){"use strict";var idx=0,arr,arrlen=0;arr=this.cacheData[where];for(idx=0,arrlen=arr.length;idx<arrlen;idx+=1){if(arr[idx].name===what){return arr[idx].content;}}
return"";},getValue:function(findarr){"use strict";var idx=0,where,what,data;for(idx=0;idx<findarr.length;idx+=1){where=findarr[idx].where;what=findarr[idx].what;if(this.inarray(this.cacheAvaible,where)>-1){this.cacheIn(where,what);data=this.getCache(where,what);}else if(where==="tag"){if(what==="title"){data=document.getElementsByTagName(what)[0].innerHTML;}else if(what==="img"){data=document.getElementsByTagName(what)[0].src;if(data===document.URL){data="";}}}
if(data!==""){return data;}}
return"";},cacheIn:function(where,what){"use strict";if(typeof this.cacheData[where]==="object"){return true;}
if(where==="meta"){this.cacheData[where]=document.getElementsByTagName(where);return true;}
return false;}};var dom="//api.nateon.nate.com";function msgSubString(maxlen,msg){if(msg.length>maxlen){msg=msg.substring(0,maxlen)+"...";}
return msg;}
function send_note(){NOTE_COMMON.log("start : send_note()");var sn_img=pageInfoFinder.getValue([{where:'meta',what:'nate:image'},{where:'meta',what:'image'},{where:'tag',what:'img'}]);var sn_title=pageInfoFinder.getValue([{where:'meta',what:'nate:title'},{where:'meta',what:'title'},{where:'tag',what:'title'}]);var sn_desc=pageInfoFinder.getValue([{where:'meta',what:'nate:description'},{where:'meta',what:'description'},{where:'tag',what:'title'}]);var doc_title=pageInfoFinder.getValue([{where:'meta',what:'nate:site_name'},{where:'meta',what:'site_name'},{where:'tag',what:'title'}]);var lurl=pageInfoFinder.getValue([{where:'meta',what:'nate:url'},{where:'meta',what:'url'}]);cust_send_note(sn_img,sn_title,sn_desc,doc_title,lurl);NOTE_COMMON.log("end : send_note()");}
function cust_send_note(sn_img,sn_title,sn_desc,doc_title,lurl){"use strict";sn_title=msgSubString(100,sn_title);sn_desc=msgSubString(300,sn_desc);doc_title=msgSubString(100,doc_title);if(lurl===""){lurl=document.location.href;}
NOTE_COMMON.log("cust_send_note()");NOTE_COMMON.log("sn_img result : "+sn_img);NOTE_COMMON.log("sn_title result : "+sn_title);NOTE_COMMON.log("sn_desc result : "+sn_desc);NOTE_COMMON.log("doc_title result : "+doc_title);NOTE_COMMON.log("lurl result : "+lurl);var frm=document.createElement("form");frm.name="frmSentNote";frm.method="post";frm.action=dom+"/web/note/SendNote.do";var input1=document.createElement("input");input1.type="hidden";input1.name="v";input1.value=encodeURIComponent("2_0");frm.appendChild(input1);var input2=document.createElement("input");input2.type="hidden";input2.name="d";input2.value=encodeURIComponent(document.URL);frm.appendChild(input2);var input3=document.createElement("input");input3.type="hidden";input3.name="encd";input3.value=encodeURIComponent(enc_note);frm.appendChild(input3);var input5=document.createElement("input");input5.type="hidden";input5.name="lurl";input5.value=encodeURIComponent(lurl);frm.appendChild(input5);var input6=document.createElement("input");input6.type="hidden";input6.name="sn_title";input6.value=encodeURIComponent(sn_title);frm.appendChild(input6);var input7=document.createElement("input");input7.type="hidden";input7.name="sn_desc";input7.value=encodeURIComponent(sn_desc);frm.appendChild(input7);var input8=document.createElement("input");input8.type="hidden";input8.name="sn_img";input8.value=encodeURIComponent(sn_img);frm.appendChild(input8);var input9=document.createElement("input");input9.type="hidden";input9.name="doc_title";input9.value=encodeURIComponent(doc_title);frm.appendChild(input9);var winopen=window.open('','note','width=650, height=650, status=yes, scrollbars=no');if(winopen==null){alert("차단된 팝업창을 허용해 주세요.");}else{document.body.appendChild(frm);frm.target="note";frm.submit();document.body.removeChild(frm);}}